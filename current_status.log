
> aqie-front-end@0.15.0 pretest
> npm run build:frontend


> aqie-front-end@0.15.0 build:frontend
> cross-env NODE_ENV=production webpack

25 assets
42 modules

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
Deprecation Warning on line 3, column 8 of file:///Users/2057586/Library/CloudStorage/OneDrive-Cognizant/Documents/cognizant-projects/defra/aqie-front-end/src/client/assets/stylesheets/application.scss:3:8:
Sass @import rules are deprecated and will be removed in Dart Sass 3.0.0.

More info and automated migrator: https://sass-lang.com/d/import

3 | @import "~govuk-frontend/dist/govuk/index";


../../../../src/client/assets/stylesheets/application.scss 4:9  root stylesheet

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
Deprecation Warning on line 4, column 28 of file:///Users/2057586/Library/CloudStorage/OneDrive-Cognizant/Documents/cognizant-projects/defra/aqie-front-end/src/client/assets/stylesheets/sass/components/_inset-text-colour.scss:4:28:
Global built-in functions are deprecated and will be removed in Dart Sass 3.0.0.
Use list.nth instead.

More info and automated migrator: https://sass-lang.com/d/import

4 |     border-left: 10px solid nth($daqi-colour, $i + 1);


../../../../src/client/assets/stylesheets/sass/components/_inset-text-colour.scss 5:29  @import
../../../../src/client/assets/stylesheets/sass/all.scss 21:9                            @import
../../../../src/client/assets/stylesheets/application.scss 13:9                         root stylesheet

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
Deprecation Warning on line 5, column 8 of file:///Users/2057586/Library/CloudStorage/OneDrive-Cognizant/Documents/cognizant-projects/defra/aqie-front-end/src/client/assets/stylesheets/application.scss:5:8:
Sass @import rules are deprecated and will be removed in Dart Sass 3.0.0.

More info and automated migrator: https://sass-lang.com/d/import

5 | @import "variables/all";


../../../../src/client/assets/stylesheets/application.scss 6:9  root stylesheet

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
Deprecation Warning on line 6, column 8 of file:///Users/2057586/Library/CloudStorage/OneDrive-Cognizant/Documents/cognizant-projects/defra/aqie-front-end/src/client/assets/stylesheets/application.scss:6:8:
Sass @import rules are deprecated and will be removed in Dart Sass 3.0.0.

More info and automated migrator: https://sass-lang.com/d/import

6 | @import "helpers/all";


../../../../src/client/assets/stylesheets/application.scss 7:9  root stylesheet

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
Deprecation Warning on line 7, column 8 of file:///Users/2057586/Library/CloudStorage/OneDrive-Cognizant/Documents/cognizant-projects/defra/aqie-front-end/src/client/assets/stylesheets/application.scss:7:8:
Sass @import rules are deprecated and will be removed in Dart Sass 3.0.0.

More info and automated migrator: https://sass-lang.com/d/import

7 | @import "core/all";


../../../../src/client/assets/stylesheets/application.scss 8:9  root stylesheet

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
Deprecation Warning on line 8, column 8 of file:///Users/2057586/Library/CloudStorage/OneDrive-Cognizant/Documents/cognizant-projects/defra/aqie-front-end/src/client/assets/stylesheets/application.scss:8:8:
Sass @import rules are deprecated and will be removed in Dart Sass 3.0.0.

More info and automated migrator: https://sass-lang.com/d/import

8 | @import "components/all";


../../../../src/client/assets/stylesheets/application.scss 9:9  root stylesheet

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
Deprecation Warning on line 35, column 2 of file:///Users/2057586/Library/CloudStorage/OneDrive-Cognizant/Documents/cognizant-projects/defra/aqie-front-end/src/client/assets/stylesheets/partials/_navigation.scss:35:2:
Sass's behavior for declarations that appear after nested
rules will be changing to match the behavior specified by CSS in an upcoming
version. To keep the existing behavior, move the declaration above the nested
rule. To opt into the new behavior, wrap the declaration in `& {}`.

More info: https://sass-lang.com/d/mixed-decls

35 |   display: inline-block;


../../../../src/client/assets/stylesheets/partials/_navigation.scss 36:3  @import
../../../../src/client/assets/stylesheets/partials/_all.scss 1:9          @import
../../../../src/client/assets/stylesheets/application.scss 10:9           root stylesheet

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
Deprecation Warning on line 35, column 2 of file:///Users/2057586/Library/CloudStorage/OneDrive-Cognizant/Documents/cognizant-projects/defra/aqie-front-end/src/client/assets/stylesheets/partials/_navigation.scss:35:2:
Sass's behavior for declarations that appear after nested
rules will be changing to match the behavior specified by CSS in an upcoming
version. To keep the existing behavior, move the declaration above the nested
rule. To opt into the new behavior, wrap the declaration in `& {}`.

More info: https://sass-lang.com/d/mixed-decls

35 |   display: inline-block;


../../../../src/client/assets/stylesheets/partials/_navigation.scss 36:3  @import
../../../../src/client/assets/stylesheets/partials/_all.scss 1:9          @import
../../../../src/client/assets/stylesheets/application.scss 10:9           root stylesheet

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
Deprecation Warning on line 35, column 2 of file:///Users/2057586/Library/CloudStorage/OneDrive-Cognizant/Documents/cognizant-projects/defra/aqie-front-end/src/client/assets/stylesheets/partials/_navigation.scss:35:2:
Sass's behavior for declarations that appear after nested
rules will be changing to match the behavior specified by CSS in an upcoming
version. To keep the existing behavior, move the declaration above the nested
rule. To opt into the new behavior, wrap the declaration in `& {}`.

More info: https://sass-lang.com/d/mixed-decls

35 |   display: inline-block;


../../../../src/client/assets/stylesheets/partials/_navigation.scss 36:3  @import
../../../../src/client/assets/stylesheets/partials/_all.scss 1:9          @import
../../../../src/client/assets/stylesheets/application.scss 10:9           root stylesheet

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
Deprecation Warning on line 36, column 2 of file:///Users/2057586/Library/CloudStorage/OneDrive-Cognizant/Documents/cognizant-projects/defra/aqie-front-end/src/client/assets/stylesheets/partials/_navigation.scss:36:2:
Sass's behavior for declarations that appear after nested
rules will be changing to match the behavior specified by CSS in an upcoming
version. To keep the existing behavior, move the declaration above the nested
rule. To opt into the new behavior, wrap the declaration in `& {}`.

More info: https://sass-lang.com/d/mixed-decls

36 |   text-decoration: none;


../../../../src/client/assets/stylesheets/partials/_navigation.scss 37:3  @import
../../../../src/client/assets/stylesheets/partials/_all.scss 1:9          @import
../../../../src/client/assets/stylesheets/application.scss 10:9           root stylesheet

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
Deprecation Warning on line 36, column 2 of file:///Users/2057586/Library/CloudStorage/OneDrive-Cognizant/Documents/cognizant-projects/defra/aqie-front-end/src/client/assets/stylesheets/partials/_navigation.scss:36:2:
Sass's behavior for declarations that appear after nested
rules will be changing to match the behavior specified by CSS in an upcoming
version. To keep the existing behavior, move the declaration above the nested
rule. To opt into the new behavior, wrap the declaration in `& {}`.

More info: https://sass-lang.com/d/mixed-decls

36 |   text-decoration: none;


../../../../src/client/assets/stylesheets/partials/_navigation.scss 37:3  @import
../../../../src/client/assets/stylesheets/partials/_all.scss 1:9          @import
../../../../src/client/assets/stylesheets/application.scss 10:9           root stylesheet

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
14 on the type scale is deprecated and will be removed as a possible option in the next major version. To silence this warning, update $govuk-suppressed-warnings with key: "govuk-typography-scale-14"

../../../govuk-frontend/dist/govuk/settings/_warnings.scss 51:5                  -warning()
../../../govuk-frontend/dist/govuk/helpers/_typography.scss 210:7                govuk-font-size()
../../../govuk-frontend/dist/govuk/helpers/_typography.scss 284:5                govuk-font()
../../../../src/client/assets/stylesheets/sass/components/_daqitable.scss 199:5  @import
../../../../src/client/assets/stylesheets/sass/all.scss 13:9                     @import
../../../../src/client/assets/stylesheets/application.scss 13:9                  root stylesheet

WARNING in ./stylesheets/application.scss
Module Warning (from ../../../node_modules/sass-loader/dist/cjs.js):
252 repetitive deprecation warnings omitted.
Run in verbose mode to see all warnings.

webpack 5.99.9 compiled with 13 warnings in 2814 ms

> aqie-front-end@0.15.0 test
> cross-env TZ=UTC NODE_OPTIONS=--max-old-space-size=4096 npx vitest run --coverage


 RUN  v3.2.4 /Users/2057586/Library/CloudStorage/OneDrive-Cognizant/Documents/cognizant-projects/defra/aqie-front-end
      Coverage enabled with v8

 âœ“ src/server/locations/helpers/convert-string.test.js (77 tests | 6 skipped) 8ms
 â¯ src/server/locations/helpers/location-type-util.test.js (13 tests | 1 failed | 2 skipped) 15ms
   âœ“ getLocationNameOrPostcode > returns engScoWal for LOCATION_TYPE_UK 1ms
   âœ“ getLocationNameOrPostcode > returns ni for LOCATION_TYPE_NI 0ms
   âœ“ getLocationNameOrPostcode > returns null for other location types 0ms
   âœ“ handleRedirect > should redirect to the given route with a 301 status code 1ms
   Ã— getMonth > returns the formatted date index 10ms
     â†’ [vitest] No "default" export is defined on the "moment-timezone" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

   âœ“ configureLocationTypeAndRedirects > sets locationNameOrPostcode for LOCATION_TYPE_UK 0ms
   âœ“ configureLocationTypeAndRedirects > sets locationNameOrPostcode for LOCATION_TYPE_NI 0ms
   â†“ configureLocationTypeAndRedirects > redirects to SEARCH_LOCATION_ROUTE_CY for Welsh language
   â†“ configureLocationTypeAndRedirects > redirects to SEARCH_LOCATION_ROUTE_EN for English path
   âœ“ filteredAndSelectedLocationType > inserts space for full postcodes without space 0ms
   âœ“ filteredAndSelectedLocationType > redirects for missing userLocation and LOCATION_TYPE_UK 1ms
   âœ“ filteredAndSelectedLocationType > redirects for missing userLocation and LOCATION_TYPE_NI 1ms
   âœ“ filteredAndSelectedLocationType > returns null for valid userLocation 0ms
 â†“ src/server/locations/helpers/create-bookmark-ids.test.js (7 tests | 7 skipped)
 âœ“ src/config/nunjucks/context/context.test.js (7 tests) 141ms
 âœ“ src/server/cookies/partials/form.test.js (1 test) 70ms
 âœ“ src/helpers/proxy-fetch-extended.test.js (2 tests) 381ms
   âœ“ proxy-fetch coverage > should export proxyFetch function  380ms
 âœ“ src/server/router.test.js (6 tests) 55ms
 â†“ src/server/locations/helpers/get-nearest.location.test.js (4 tests | 4 skipped)
 âœ“ src/index.test.js (6 tests) 52ms
 âœ“ src/server/index.test.js (15 tests) 53ms
 âœ“ src/server/home/partials/start-button.test.js (2 tests) 32ms
 âœ“ src/server/multiple-results/controller.test.js (8 tests) 72ms
 âœ“ src/config/nunjucks/index.test.js (4 tests) 34ms
 âœ“ src/server/check-local-air-quality/partials/start-button.test.js (2 tests) 35ms
 âœ“ src/server/check-local-air-quality/partials/inset-text.test.js (2 tests) 35ms
 âœ“ test/daqi-columns.test.js (4 tests) 60ms
stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Value Testing - Moderate Range (4, 5, 6) > should handle DAQI value 4 (Moderate - Low)
âœ“ DAQI 4 (Moderate-Low): {
  value: [33m4[39m,
  band: [32m'moderate'[39m,
  advice: [32m'For most people, short term exposure to moderate levels of air pollution is not an issue.'[39m
}

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Value Testing - Moderate Range (4, 5, 6) > should handle DAQI value 5 (Moderate - Mid)
âœ“ DAQI 5 (Moderate-Mid): {
  value: [33m5[39m,
  band: [32m'moderate'[39m,
  atRiskAdvice: {
    adults: [32m'Adults who have heart problems and feel unwell should consider doing less strenuous exercise, especially outside.'[39m,
    asthma: [32m'People with asthma should be prepared to use their reliever inhaler.'[39m
  }
}

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Value Testing - Moderate Range (4, 5, 6) > should handle DAQI value 6 (Moderate - High)
âœ“ DAQI 6 (Moderate-High): {
  value: [33m6[39m,
  band: [32m'moderate'[39m,
  oldPeopleAdvice: [32m'Older people should consider doing less strenuous activity, especially outside.'[39m
}

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Value Testing - Moderate Range (4, 5, 6) > should simulate moderate range responsive behavior
âœ“ Moderate range responsive behavior tested for values 4, 5, 6

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Value Testing - High Range (7, 8, 9) > should handle DAQI value 7 (High - Low)
âœ“ DAQI 7 (High-Low): {
  value: [33m7[39m,
  band: [32m'high'[39m,
  advice: [32m'Anyone experiencing discomfort such as sore eyes, cough or sore throat should consider reducing activity, particularly outdoors.'[39m
}

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Value Testing - High Range (7, 8, 9) > should handle DAQI value 8 (High - Mid)
âœ“ DAQI 8 (High-Mid): {
  value: [33m8[39m,
  band: [32m'high'[39m,
  atRiskAdvice: {
    adults: [32m'Adults with heart problems should reduce strenuous physical exertion, particularly outdoors, especially if they experience symptoms.'[39m,
    asthma: [32m'People with asthma may find they need to use their reliever inhaler more often.'[39m
  }
}

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Value Testing - High Range (7, 8, 9) > should handle DAQI value 9 (High - High)
âœ“ DAQI 9 (High-High): {
  value: [33m9[39m,
  band: [32m'high'[39m,
  oldPeopleAdvice: [32m'Older people should reduce physical exertion.'[39m,
  outlook: [32m'Warm temperatures are expected to increase pollution levels to high across many areas today.'[39m
}

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Value Testing - High Range (7, 8, 9) > should simulate high range visual positioning
âœ“ High range visual positioning tested for values 7, 8, 9

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Value Testing - Very High Range (10) > should handle DAQI value 10 (Very High)
âœ“ DAQI 10 (Very High): {
  value: [33m10[39m,
  band: [32m'veryHigh'[39m,
  readableBand: [32m'very high'[39m,
  advice: [32m'Reduce physical exertion, particularly outdoors, especially if you experience symptoms such as cough or sore throat.'[39m,
  atRiskAdvice: {
    adults: [32m'Adults with heart problems should avoid strenuous physical activity.'[39m,
    asthma: [32m'People with asthma may need to use their reliever inhaler more often.'[39m,
    oldPeople: [32m'Older people should avoid strenuous physical activity.'[39m
  }
}

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Value Testing - Very High Range (10) > should handle very high value visual representation
âœ“ DAQI 10 visual representation - Last segment with 100px width
Air quality data: {
  value: [33m10[39m,
  band: [32m'veryHigh'[39m,
  readableBand: [32m'very high'[39m,
  advice: [32m'Reduce physical exertion, particularly outdoors, especially if you experience symptoms such as cough or sore throat.'[39m,
  atrisk: {
    adults: [32m'Adults with heart problems should avoid strenuous physical activity.'[39m,
    asthma: [32m'People with asthma may need to use their reliever inhaler more often.'[39m,
    oldPeople: [32m'Older people should avoid strenuous physical activity.'[39m
  },
  outlook: [32m'The current heatwave shows no signs of relenting, causing air pollution levels to remain very high across many areas today.'[39m
}

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Value Testing - Very High Range (10) > should simulate outlook messaging for very high
âœ“ DAQI 10 outlook: The current heatwave shows no signs of relenting, causing air pollution levels to remain very high across many areas today.

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Range Comparison Tests > should show escalating severity across ranges
âœ“ Escalating severity comparison:
  Moderate (5): Adults who have heart problems and feel unwell should consider doing less strenuous exercise, especially outside.
  High (8): Adults with heart problems should reduce strenuous physical exertion, particularly outdoors, especially if they experience symptoms.
  Very High (10): Adults with heart problems should avoid strenuous physical activity.

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Range Comparison Tests > should test responsive divider positioning across all ranges
âœ“ Responsive divider positioning tested for all target values: 4-10

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Range Comparison Tests > should simulate mobile vs desktop responsive behavior
âœ“ Mobile vs Desktop responsive behavior simulation complete

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Integration with JavaScript Columns > should test divider calculations with moderate values
âœ“ Moderate values (4,5,6) segment integration verified

stdout | test/daqi-simulation.test.js > DAQI Simulation Tests > DAQI Integration with JavaScript Columns > should test CSS custom property setting for divider positions
âœ“ CSS divider positions calculated:
  Divider 1 (after Low): 156px
  Divider 2 (after Moderate): 315px
  Divider 3 (after High): 474px

 âœ“ test/daqi-simulation.test.js (16 tests) 94ms
 âœ“ test/daqi-accessibility.test.js (6 tests) 107ms
 âœ“ src/helpers/proxy-agent.test.js (4 tests) 25ms
 âœ“ src/server/home/partials/inset-text.test.js (2 tests) 32ms
 âœ“ src/config/nunjucks/filters/format-currency.test.js (2 tests) 16ms
 âœ“ src/server/cookies/partials/notification-banner.test.js (1 test) 27ms
 âœ“ src/config/nunjucks/globals/globals.test.js (3 tests) 12ms
stdout | daqi-contrast-accessibility-tester.test.js
ğŸ¯ Focused element 1: A - "Today"
   Visible: false, Size: 0x0

stdout | daqi-contrast-accessibility-tester.test.js
ğŸ¯ Focused element 1: A - "Today"
   Visible: false, Size: 0x0

 âœ“ daqi-contrast-accessibility-tester.test.js (36 tests) 696ms
 âœ“ src/server/locations/helpers/fetch-data.test.js (23 tests | 1 skipped) 11ms
 âœ“ test/daqi-columns-grouped.test.js (1 test) 37ms
 âœ“ test/daqi-columns-resize.test.js (1 test) 40ms
 âœ“ test/forecast-partial.test.js (1 test) 36ms
stdout | src/server/location-id/cy/controller.test.js > Welsh Location ID Controller > getLocationDetailsController > should redirect to Welsh location search when no previous URL and no saved search terms
redirectioning to location search 2

 âœ“ src/server/nitrogen-dioxide/index.test.js (1 test) 8ms
 âœ“ src/server/location-id/cy/controller.test.js (15 tests) 11ms
 âœ“ src/server/location-id/controller.test.js (18 tests) 10ms
 âœ“ src/server/sulphur-dioxide/cy/index.test.js (1 test) 7ms
 âœ“ src/server/location-id/cy/index.test.js (1 test) 8ms
 âœ“ src/server/health/controller.test.js (2 tests) 11ms
 âœ“ src/server/multiple-results/index.test.js (1 test) 7ms
 âœ“ src/server/locations/controller.test.js (19 tests) 6ms
 âœ“ src/server/locations/helpers/extra-middleware-helpers.test.js (12 tests) 8ms
 âœ“ src/server/search-location/index.test.js (1 test) 7ms
 âœ“ src/server/locations/helpers/middleware-helpers.test.js (25 tests) 8ms
 âœ“ src/server/privacy/index.test.js (1 test) 7ms
 âœ“ src/server/search-location/cy/index.test.js (1 test) 7ms
 âœ“ src/server/home/cy/controller.test.js (11 tests) 5ms
 âœ“ src/server/health/index.test.js (1 test) 7ms
 âœ“ src/server/privacy/controller.test.js (2 tests) 3ms
 âœ“ src/server/locations/middleware.test.js (11 tests) 7ms
 âœ“ src/server/nitrogen-dioxide/cy/index.test.js (1 test) 7ms
 âœ“ src/server/privacy/cy/index.test.js (1 test) 7ms
 âœ“ src/server/particulate-matter-25/index.test.js (1 test) 7ms
 âœ“ src/server/particulate-matter-10/cy/index.test.js (1 test) 7ms
 âœ“ src/server/particulate-matter-25/cy/index.test.js (1 test) 7ms
 âœ“ src/server/ozone/index.test.js (1 test) 11ms
 âœ“ src/server/particulate-matter-10/index.test.js (1 test) 7ms
 âœ“ src/server/sulphur-dioxide/index.test.js (1 test) 14ms
 âœ“ src/server/ozone/cy/index.test.js (1 test) 10ms
 âœ“ src/helpers/proxy-fetch.test.js (4 tests) 9ms
 âœ“ src/server/error/partials/error-500.test.js (1 test) 17ms
 âœ“ src/server/accessibility/partials/paragraphs-and-headings.test.js (1 test) 13ms
 âœ“ src/server/location-id/helpers/renderLocationNotFoundView.test.js (4 tests) 4ms
 âœ“ src/server/cookies/partials/paragraphs.test.js (1 test) 14ms
 âœ“ src/server/data/monitoring-sites.test.js (21 tests) 7ms
 âœ“ src/server/error/partials/error-404-cy.test.js (1 test) 10ms
 âœ“ src/server/error/partials/error-404-en.test.js (1 test) 6ms
 âœ“ src/server/cookies/cy/controller.test.js (12 tests) 5ms
 âœ“ src/server/locations/helpers/error-input-and-redirect-helpers.test.js (9 tests) 5ms
 âœ“ src/server/search-location/controller.test.js (6 tests) 7ms
 âœ“ src/server/locations/helpers/transform-summary-keys.test.js (6 tests) 5ms
 âœ“ src/server/accessibility/partials/page-title.test.js (1 test) 10ms
 âœ“ src/config/index.test.js (21 tests) 5ms
 âœ“ src/server/search-location/cy/controller.test.js (4 tests) 4ms
 âœ“ src/server/locations/helpers/location-util.test.js (6 tests) 4ms
 âœ“ src/server/particulate-matter-25/controller.test.js (2 tests) 3ms
 âœ“ src/server/location-not-found/controller.test.js (3 tests | 1 skipped) 3ms
 âœ“ src/server/home/controller.test.js (2 tests) 3ms
 âœ“ src/server/location-id/helpers/renderLocationDetailsView.test.js (2 tests) 4ms
 âœ“ src/server/locations/helpers/convert-first-letter-into-upper-case.test.js (8 tests) 2ms
 âœ“ src/server/ozone/controller.test.js (2 tests) 3ms
 âœ“ src/server/locations/helpers/handle-error-helpers.test.js (5 tests) 4ms
 âœ“ src/server/accessibility/controller.test.js (3 tests) 6ms
 âœ“ src/server/location-id/helpers/matchLocationId.test.js (2 tests) 3ms
 âœ“ src/server/locations/helpers/get-postcode-type.test.js (23 tests) 5ms
 âœ“ src/server/accessibility/cy/controller.test.js (3 tests) 3ms
 âœ“ src/server/data/constants.test.js (9 tests) 3ms
 âœ“ src/server/cookies/controller.test.js (3 tests) 4ms
 âœ“ src/server/privacy/cy/controller.test.js (3 tests) 6ms
 âœ“ src/server/particulate-matter-25/cy/controller.test.js (3 tests) 3ms
 âœ“ src/server/location-id/helpers/redirectToWelshLocation.test.js (6 tests) 3ms
 âœ“ src/server/ozone/cy/controller.test.js (3 tests) 4ms
 âœ“ src/config/nunjucks/filters/format-date.test.js (2 tests) 4ms
 âœ“ src/server/data/en/air-quality.test.js (13 tests) 3ms
 âœ“ src/server/sulphur-dioxide/cy/controller.test.js (2 tests) 3ms
 âœ“ src/server/location-id/helpers/handleSearchTermsRedirection.test.js (5 tests) 3ms
 âœ“ src/config/nunjucks/globals/index.test.js (5 tests) 2ms
 âœ“ src/server/nitrogen-dioxide/controller.test.js (2 tests) 3ms
 âœ“ src/server/sulphur-dioxide/controller.test.js (2 tests) 3ms
 âœ“ src/server/nitrogen-dioxide/cy/controller.test.js (3 tests) 4ms
 âœ“ src/server/check-local-air-quality/cy/controller.test.js (3 tests) 3ms
 âœ“ src/server/location-not-found/cy/controller.test.js (2 tests) 4ms
 âœ“ src/server/locations/helpers/show-location-page.test.js (3 tests) 4ms
 âœ“ src/server/location-not-found/index.test.js (1 test) 3ms
 âœ“ src/server/particulate-matter-10/cy/controller.test.js (3 tests) 3ms
 âœ“ src/server/locations/helpers/get-ni-places.test.js (2 tests) 3ms
 âœ“ src/server/locations/index.test.js (4 tests) 3ms
 âœ“ src/server/location-id/helpers/determineNearestLocation.test.js (2 tests) 3ms
 âœ“ src/server/locations/helpers/gazetteer-util.test.js (11 tests) 3ms
 âœ“ src/server/locations/helpers/get-os-places.test.js (2 tests) 3ms
 âœ“ src/server/locations/helpers/generate-title-data.test.js (2 tests) 2ms
 âœ“ src/server/locations/helpers/error-input-and-redirect.test.js (2 tests) 3ms
 âœ“ src/server/particulate-matter-10/controller.test.js (2 tests) 3ms
 âœ“ src/server/data/cy/air-quality.test.js (13 tests) 3ms
 âœ“ src/server/locations/helpers/get-search-terms-from-url.test.js (7 tests) 2ms
 âœ“ src/server/check-local-air-quality/controller.test.js (2 tests) 3ms
stderr | src/helpers/testRedisConnection.test.js > testRedisConnection > should return false when Redis connection fails
Redis connection test failed: Connection failed

stderr | src/helpers/testRedisConnection.test.js > testRedisConnection > should handle Redis ping timeout gracefully
Redis connection test failed: Timeout

stderr | src/helpers/testRedisConnection.test.js > testRedisConnection > should disconnect Redis client even if ping fails
Redis connection test failed: Network error

 âœ“ src/helpers/testRedisConnection.test.js (4 tests) 3ms
 âœ“ src/server/locations/helpers/reduce-matches.test.js (8 tests | 1 skipped) 3ms
 âœ“ src/server/location-not-found/cy/index.test.js (1 test) 2ms
 âœ“ src/server/locations/helpers/filter-by-postcode.test.js (3 tests) 2ms
 âœ“ src/server/locations/helpers/cy/pollutant-level-calculation.test.js (6 tests) 2ms
 âœ“ src/server/multiple-results/cy/controller.test.js (2 tests) 3ms
 âœ“ src/server/location-id/index.test.js (2 tests) 3ms
 âœ“ src/config/nunjucks/globals.test.js (8 tests) 3ms
 âœ“ src/server/locations/helpers/get-ni-single-data.test.js (7 tests | 1 skipped) 2ms
 âœ“ src/server/locations/helpers/pollutant-level-calculation.test.js (6 tests) 2ms
 âœ“ src/server/multiple-results/cy/index.test.js (1 test) 2ms
 âœ“ src/server/data/cy/monitoring-sites.test.js (12 tests) 3ms
 âœ“ src/server/locations/helpers/search-terms-unitary.test.js (20 tests | 4 skipped) 2ms
 âœ“ src/server/data/air-quality.test.js (11 tests) 2ms
 âœ“ src/server/help/controller.test.js (2 tests) 1ms
 âœ“ src/server/data/en/monitoring-sites.test.js (12 tests) 2ms
 âœ“ src/server/accessibility/routes.test.js (1 test) 3ms
 âœ“ src/server/locations/helpers/routes-titles-util.test.js (4 tests) 3ms
 âœ“ src/server/accessibility/cy/constants.test.js (2 tests) 1ms
 âœ“ src/server/locations/helpers/search-terms-borough.test.js (16 tests | 5 skipped) 2ms
 âœ“ src/server/accessibility/cy/routes.test.js (1 test) 2ms
 âœ“ src/server/locations/helpers/filter-by-search-terms.test.js (2 tests) 2ms
 âœ“ src/server/check-local-air-quality/index.test.js (1 test) 1ms
 âœ“ src/server/locations/helpers/handle-single-match-helper.test.js (2 tests) 2ms
 âœ“ src/server/accessibility/cy/index.test.js (1 test) 1ms
 âœ“ src/server/locations/helpers/filter-matches.test.js (2 tests) 2ms
 âœ“ src/config/nunjucks/context/build-navigation.test.js (2 tests) 2ms
 âœ“ src/server/home/routes.test.js (1 test) 2ms
 âœ“ src/server/location-id/helpers/determineLocationType.test.js (4 tests) 2ms
 âœ“ src/server/locations/helpers/air-quality-values.test.js (5 tests) 2ms
 âœ“ src/server/locations/helpers/get-nearest-location.test.js (2 tests) 2ms
 âœ“ src/server/check-local-air-quality/routes.test.js (1 test) 2ms
 âœ“ src/server/check-local-air-quality/cy/routes.test.js (1 test) 2ms
 âœ“ src/server/accessibility/index.test.js (1 test) 3ms
 âœ“ src/server/home/cy/routes.test.js (1 test) 3ms
 âœ“ src/server/error/controller.test.js (2 tests) 1ms
 âœ“ src/server/home/index.test.js (1 test) 1ms
 âœ“ src/server/cookies/index.test.js (1 test) 1ms
 âœ“ src/server/location-id/helpers/helpers.test.js (2 tests) 1ms
 âœ“ src/server/cookies/routes.test.js (1 test) 2ms
 âœ“ src/server/cookies/cy/index.test.js (1 test) 2ms
 âœ“ src/server/check-local-air-quality/cy/index.test.js (1 test) 1ms
 âœ“ src/server/home/cy/index.test.js (1 test) 2ms
 âœ“ src/server/cookies/cy/routes.test.js (1 test) 1ms

â¯â¯â¯â¯â¯â¯â¯ Failed Tests 1 â¯â¯â¯â¯â¯â¯â¯

 FAIL  src/server/locations/helpers/location-type-util.test.js > getMonth > returns the formatted date index
Error: [vitest] No "default" export is defined on the "moment-timezone" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi[33m.[39m[34mmock[39m([35mimport[39m([32m"moment-timezone"[39m)[33m,[39m [35masync[39m (importOriginal) [33m=>[39m {
  [35mconst[39m actual [33m=[39m [35mawait[39m [34mimportOriginal[39m()
  [35mreturn[39m {
    [33m...[39mactual[33m,[39m
    [90m// your mocked methods[39m
  }
})

 â¯ Module.getMonth src/server/locations/helpers/location-type-util.js:28:25
     26| 
     27| const getMonth = () => {
     28|   const formattedDate = moment().format('DD MMMM YYYY').split(' ')
       |                         ^
     29|   const getFormattedDate = calendarEnglish.findIndex(
     30|     (item) => item.indexOf(formattedDate[1]) !== -1
 â¯ src/server/locations/helpers/location-type-util.test.js:66:12

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/1]â¯


 Test Files  1 failed | 152 passed | 2 skipped (155)
      Tests  1 failed | 797 passed | 32 skipped (830)
   Start at  12:51:18
   Duration  12.37s (transform 2.91s, setup 0ms, collect 37.27s, tests 2.72s, environment 19ms, prepare 25.13s)

