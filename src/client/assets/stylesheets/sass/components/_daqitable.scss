// Daqi table
@namespace "http://www.w3.org/2000/svg";

svg|svg { 
  forced-color-adjust: preserve-parent-color; 
}

svg|foreignObject { 
  forced-color-adjust: auto; 
}

.daqi-labels {
  display: flex;
  white-space: nowrap;
  justify-content: space-between; 
  position: relative;
  margin-top: govuk-spacing(2);
}

.daqi-bar {
  display: flex;
  height: govuk-spacing(4);
  margin-bottom: govuk-spacing(2);
  border: 1px solid transparent;
}

.daqi-bar-segment {
  width: 10%;
  height: 100%;
  margin-right: 2px;
  border-right: 1px solid transparent;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: govuk-colour("light-grey");
}

.daqi-bar-segment:last-child {
  border-right: none;
  margin-right: 0;
}

// '' DAQI numbered bar styling to match design image exactly
.daqi-numbered {
  position: relative;

  .daqi-bar {
    // stylelint-disable-next-line declaration-no-important
    display: flex !important;
    // stylelint-disable-next-line declaration-no-important
    height: 40px !important;
    margin-bottom: govuk-spacing(2);
    border: none;
    position: relative;
    gap: 3px;

    // '' vertical separators at gaps between 3|4, 6|7, 9|10 (centered in 3px gaps)
    background-image:
      linear-gradient(to bottom, govuk-colour("black"), govuk-colour("black")),
      linear-gradient(to bottom, govuk-colour("black"), govuk-colour("black")),
      linear-gradient(to bottom, govuk-colour("black"), govuk-colour("black"));
    background-repeat: no-repeat;
    background-size: 1px 24px; // '' 1px wide, 24px tall
    // '' positions computed as: n*50px + (n-1)*3px + 1.5px for n in {3,6,9}
    background-position: 157.5px center, 316.5px center, 475.5px center;
  }

  .daqi-bar-segment {
    height: 100%;
    border: none;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: govuk-colour("light-grey");
    box-sizing: border-box; // '' include border in width for exact alignment
    letter-spacing: 0; // '' avoid text width affecting perceived centering
  // stylelint-disable-next-line declaration-no-important
  margin-right: 0 !important; // '' remove generic 2px margin-right to rely solely on gap:3px
    
    width: 50px;
    
    &:nth-child(10) {
      width: 100px;
    }
    
    &.daqi-1, &.daqi-2, &.daqi-3, &.daqi-4, &.daqi-5, 
    &.daqi-6, &.daqi-7, &.daqi-8, &.daqi-9, &.daqi-10 {
      border: 2px solid govuk-colour("black");
    }
  }

  .daqi-labels {
    display: grid;
    grid-template-columns: repeat(9, 50px) 100px; // exactly the 10 cells widths
    column-gap: 3px; // '' match the bar's inter-cell gap so label centers align
    align-items: center;
    margin-top: govuk-spacing(2);
    position: relative;
    justify-items: stretch; // '' make grid items occupy full column span
    justify-content: start; // '' prevent space-between from generic .daqi-labels rule
    align-content: start;
  // padding removed to keep grid perfectly aligned with bar geometry
    
    .daqi-band {
      @include govuk-font($size: 16, $weight: regular);
        // stylelint-disable-next-line declaration-no-important
        text-align: center !important; // '' override generic .daqi-band alignment
      position: relative; // '' allow anchor for separators
      display: block;
        justify-self: stretch; // default - overridden per-label below
      white-space: nowrap; // '' prevent labels from wrapping onto two lines
      // stylelint-disable-next-line declaration-no-important
      width: auto !important; // '' override generic width rules incl. nth-child(3)/last-child
      max-width: 100%;
      // stylelint-disable-next-line declaration-no-important
      border: 0 !important; // '' remove any generic borders (e.g., 3px white)
      // stylelint-disable-next-line declaration-no-important
      padding: 0 !important;
      // stylelint-disable-next-line declaration-no-important
      margin: 0 !important;
      
      // Low - spans cells 1,2,3 (3 tracks)
      &:nth-child(1) {
        grid-column: 1 / 4;
      }
      
      // Moderate - center under cell 5
      &:nth-child(2) {
        grid-column: 5 / 6;
        // stylelint-disable-next-line declaration-no-important
        justify-self: center !important;
        // stylelint-disable-next-line declaration-no-important
        width: max-content !important;
        transform: translateX(-10px); // '' shift ~5px towards Low per request
      }
      
      // High - span cells 7â€“9 (center aligns to cell 8)
      &:nth-child(3) {
        grid-column: 8 / 9; // '' pin to the exact column for cell 8
        justify-self: center;
        // stylelint-disable-next-line declaration-no-important
        width: max-content !important;
        // '' micro-nudge for optical centering
        transform: translateX(-0.5px);
      }
      
      // Very high - center under cell 10 (100px wide track)
      &:nth-child(4) {
        grid-column: 10 / 11;
        justify-self: center;
        // stylelint-disable-next-line declaration-no-important
        width: max-content !important;
      }
    }
  }
}

  .daqi-number {
    @include govuk-font($size: 16, $weight: bold);
    color: govuk-colour("black");
    position: relative;
    z-index: 5;
  }

// Active/selected segment styling
.daqi-bar-segment.daqi-1,
.daqi-bar-segment.daqi-2,
.daqi-bar-segment.daqi-3 {
  background-color: $daqi-colour-1;

  .daqi-number {
    color: govuk-colour("white");
  }
}

.daqi-bar-segment.daqi-4,
.daqi-bar-segment.daqi-5,
.daqi-bar-segment.daqi-6 {
  background-color: $daqi-colour-4;

  .daqi-number {
    color: govuk-colour("black");
  }
}

.daqi-bar-segment.daqi-7,
.daqi-bar-segment.daqi-8 {
  background-color: $daqi-colour-7;

  .daqi-number {
    color: govuk-colour("white");
  }
}

.daqi-bar-segment.daqi-9,
.daqi-bar-segment.daqi-10 {
  background-color: $daqi-colour-9;

  .daqi-number {
    color: govuk-colour("white");
  }
}

.daqi-band {
  @include govuk-font($size: 16, $weight: regular);
  border: 0;
  vertical-align: top;
  text-align: left;
  width: 30%;
}

.daqi-band:last-child, .daqi-band:nth-child(3) {
  width: 20%;
}

.daqi-band:last-child {
  text-align: right;
  white-space: nowrap;
}

.daqi-selected {
  font-weight: bold; 
}

@media (prefers-contrast: more) {
  .daqi-selected {
    background-color: windowText;
    color: windowText;
  }
}

@media(forced-colors: active) {
  .daqi-selected {
    // stylelint-disable-next-line declaration-no-important
      background-color: windowText !important;
      forced-color-adjust: none;
      color: govuk-colour("black");
  }
}
@media(forced-colors: active) {
  .daqi-selected,
  .aq-forecast-dd.daqi-tag--1, 
  .aq-forecast-dd.daqi-tag--2, 
  .aq-forecast-dd.daqi-tag--3, 
  .aq-forecast-dd.daqi-tag--4, 
  .aq-forecast-dd.daqi-tag--5, 
  .aq-forecast-dd.daqi-tag--6, 
  .aq-forecast-dd.daqi-tag--7, 
  .aq-forecast-dd.daqi-tag--8, 
  .aq-forecast-dd.daqi-tag--9, 
  .aq-forecast-dd.daqi-tag--10  {
    // stylelint-disable-next-line declaration-no-important
      background-color: windowText !important;
      forced-color-adjust: none;
      color: govuk-colour("black");
  }

  .aq-forecast-item {
    .aq-forecast-dd.daqi-tag--2 {
      border-right: 2px solid govuk-colour("black");  
      width: 100%;          
    } 
  }

 .aq-forecast-item:last-child { 
  .aq-forecast-dd.daqi-tag--2 {
      border-right: 1px solid windowText; 
   } 
  }
}

@media (inverted-colors: inverted) {
  .daqi-selected {
    background-color: windowText;
    color: govuk-colour("black");
  }
}

.daqi-0 {
  background-color: $daqi-colour-0;
  color: govuk-colour("black");
}

.daqi-1 {
  background-color: $daqi-colour-1;
  color: govuk-colour("white");
  font-weight: bold; 
}
  
.daqi-2 {
  background-color: $daqi-colour-2;
  color: govuk-colour("white");
  font-weight: bold; 
}
  
.daqi-3 {
  background-color: $daqi-colour-3;
  color: govuk-colour("white");
  font-weight: bold; 
}
  
.daqi-4 {
  background-color: $daqi-colour-4;
  color: govuk-colour("black");
  font-weight: bold; 
}
  
.daqi-5 {
  background-color: $daqi-colour-5;
  color: govuk-colour("black");
  font-weight: bold; 
}
  
.daqi-6 {
  background-color: $daqi-colour-6;
  color: govuk-colour("black");
  font-weight: bold; 
}
  
.daqi-7 {
  background-color: $daqi-colour-7;
  color: govuk-colour("white");
  font-weight: bold; 
}
  
.daqi-8 {
  background-color: $daqi-colour-8;
  color: govuk-colour("white");
  font-weight: bold; 
}
  
.daqi-9 {
  background-color: $daqi-colour-9;
  color: govuk-colour("white");
  font-weight: bold; 
 }
  
.daqi-10 {
  background-color: $daqi-colour-10;
  color: govuk-colour("white");
  font-weight: bold; 
}

// '' Ensure Moderate relies on grid centering exactly under cell 5 (no transform)

.govuk-details__text {
  .health-advice tr:last-child td,
  .health-advice tr:last-child th {
    border-bottom: 1px solid transparent;
  }
}

.govuk-tabs__tab {
  display: inline-block;
  max-width: 12ch;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.defra-aq-tabs__label-distance {
  padding-top: 5px;
  display: block;
  font-family: "GDS Transport", arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  font-weight: 400;
  font-size: 0.875rem;
  line-height: 1.1429;
  text-decoration: none;
}

@media (min-width: 40.0625em) {
  .defra-aq-tabs__label-distance {
    font-size: 1.1rem;
    line-height: 0.5;
  }
}